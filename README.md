# intv-comp

**チームみらい** のインタビューレポートグランプリ用リポジトリ

## 開発言語

このプロジェクトは **Python** で開発されています。

## 主な機能

### AIインタビューログ分析

このリポジトリは、AIインタビューログを分析して政策立案者向けの高品質なレポートを生成します。

#### 従来モード（チャンク分析）
- 全メッセージをチャンクに分割して分析
- 全体俯瞰レポートを生成

#### 政策モード（新機能）
- 政策ごとに1本のレポートを生成
- 5部構成のレポートフォーマット：
  1. Executive Summary
  2. 触れられていない論点（Blind Spots）
  3. 回答の一貫性・揺らぎ
  4. 回答が示す意味の整理（Implication Clarity）
  5. 主要原文引用
- **全ての引用に外部公開URLを付与**（GitHub内部リンク禁止）

詳細は [外部リンク引用対応機能のドキュメント](docs/external_link_citation.md) を参照してください。

## コントリビューション

このリポジトリへの貢献を歓迎します。貢献する前に [CONTRIBUTING.md](CONTRIBUTING.md) をお読みください。

**重要**: このリポジトリでは、コミットメッセージ、プルリクエスト、コードレビューは **全て日本語** で記載してください。

## ガイドライン

- コミットメッセージ: 日本語で記載
- プルリクエスト: 日本語で記載
- コードレビュー: 日本語で記載

## git clone 時の注意点

このプロジェクトではパッケージ管理に **uv** を利用しています。
git cloneでプロジェクトをcloneしてきた後は仮想環境を作成したうえでパッケージを同期して下さい。

- 仮想環境の作成　→ `uv venv .venv`
- 仮想環境の有効化　→ `source .venv/bin/activate`
- パッケージの同期　→　`uv sync`
**作業する前は必ず仮想化の有効化を行って下さい！**
`source .venv/bin/activete`

## Git LFS のインストール

解析で使用するデータが少し大きいです。
そのデータをgit管理してしまうとブランチを取得するたびにデータも取得してしまい容量を圧迫してしまいます。
そのためGit LFS（Large File Storage）という機能を使います。　（Github公式の機能）

- `git clone` した後１度だけ
  `git lfs install --skip-smudge --force`
  を行って、ローカルリポジトリに **Git LFSを導入** して下さい。
  ただし、初回の**git clone**では落ちてきます。（2回目のgit cloneからファイルポインタになります）
- ブランチを取得してきたときはファイルポインタのみ取得されます。
  `git lfs pull` でファイルの実体を取得できます。
  なお、特定のファイルだけpullしたいときは以下のようなコマンドです。
  `git lfs pull --include="data/raw/bill-of-lading_messages.csv"`

## commit前のチェック＆整形

プログラムソースの一貫性を保つため

- **ruff** による静的チェック　→ `task lint`
- **mypy** による型チェック　→ `task typecheck`
- **format** によるソース整形　→　`task format`

を実施して下さい。

  **`task check`** でruff/mypyのチェックを行うことも可能です。

## git commit 時の注意点

このプロジェクトでは **commitizen** を導入しています。
そのため、以下の手順にてcommitをお願いします。

1. 対象ファイルをステージング
   `git add .`
   のように通常通り対象ファイルをステージングしてください。

2. commit
   今回、ここが違います。
   `cz commit`
   にてコミットを行って下さい。
   コマンド入力後、各プロンプトに沿って値を入力して下さい。

3. viエディタで書き込み
   一通り値を入力したらviエディタが開きます。
   commitしてよければ escキーを１回押して、`:wq` を入力して
   `enterキー` を押して下さい。
   commitしたくなければ escキーを１回押して、`:q!` を入力して
   `enterキー` を押して下さい。

> **commitizen のバージョン管理**

バージョン更新 & changelog 自動生成は以下のコマンドを入力して下さい。
`cz bump`
